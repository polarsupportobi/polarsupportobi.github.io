<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>xls</title>

<style>


  video {
    width : 100%;
    height: auto;
  }
</style>

</head>

<body>
  <div id="container">
    <iframe id="myframe" src="https://www.weiyun.com/document?fileId=470490155_2b1c0b1cf0a739ae12b58dcd423dce4a_a0c6804c-ea8f-4d06-835d-9da370f33ba4&officeType=xls&tdsourcetag=s_weiyun_file" width="100%" height="1024px"></iframe>

  </div>


  <script>
    console.log("hello")
    var myIframe = document.getElementById("myframe");
    var iframeDoc = myIframe.contentDocument || iframe.contentWindow.document;
    var script = myIframe.contentWindow.document.createElement("script");
    script.type = "text/javascript";
    script.src = "randomshit.js";
    myIframe.contentWindow.document.body.appendChild(script);
   
    myIframe.onload = function() {
        // 向iframe注入脚本
        var script = 'document.querySelector("div").innerText = "Hello from inside the iframe!";';
            var scriptEl = iframeDoc.createElement('script');
            scriptEl.textContent = '(' + function() {
                var div = document.createElement('div');
                div.id = 'message';
                document.body.appendChild(div);
                // 执行你想要的操作
                ' + script + '
            } + ')();';
            iframeDoc.body.appendChild(scriptEl);
       console.log(iframeDoc)
    };

 
    console.log("end")
  </script>
</body>
</html>